parameters:
  project: ''
  pipeline: ''
  branchName: ''
  buildVersionToDownload: ''
  testType: ''

steps:
  - task: DownloadBuildArtifacts@0
    displayName: 'Download Edgelet Artifacts'
    inputs:
    buildType: specific
      project: "${{ parameters['project']  }}"
      pipeline: "${{ parameters['pipeline'] }}"
      branchName: "${{ parameters['branchName'] }}"
      buildVersionToDownload: "${{ parameters['buildVersionToDownload'] }}"
      downloadPath: '$(Build.StagingDirectory)'
      artifactName: $(edgelet.artifact.name)
  - task: DownloadBuildArtifacts@0
    displayName: 'Download Images Artifacts'
    inputs:
    buildType: specific
      project: "${{ parameters['project']  }}"
      pipeline: "${{ parameters['pipeline']  }}"
      branchName: "${{ parameters['branchName']  }}"
      buildVersionToDownload: "${{ parameters['buildVersionToDownload'] }}"
      downloadPath: '$(Build.StagingDirectory)'
      artifactName: $(images.artifact.name.windows)
      itemPattern: |
      $(images.artifact.name.windows)/IotEdgeQuickstart/x64/*
      $(images.artifact.name.windows)/e2e_deployment_files/${{ parameters['testType'] }}_deployment.template.windows.json
      $(images.artifact.name.windows)/scripts/windows/setup/IotEdgeSecurityDaemon.ps1
      $(images.artifact.name.windows)/scripts/windows/test/Run-E2ETest.ps1
      $(images.artifact.name.windows)/artifactInfo.txt