# End-to-end tests should run after new docker images and edgelet packages are
# built, but 'build completion triggers' are not yet supported in YAML. Set to
# 'none' here and override in the online editor.
trigger: none
pr: none

jobs:
################################################################################	
  - job: rbpi_arm64_docker
################################################################################	
    displayName: RBPi ARM64 Docker

    pool:
      name: $(pool.name)
      demands:
        - sh
        - stealingThisToRunNewE2E -equals true
        - agent-osbits -equals 64
        - Agent.OS -equals Linux
        - Agent.OSArchitecture -equals ARM

    variables:
      os: linux
      arch: ARM64
      artifactDir: iotedged-rbpi-arm64-docker

    steps:
    - bash: |
        # We use a self-hosted agent for this job, so we need to handle
        # cleanup of root-owned files ourselves (anything created during
        # `sudo dotnet vstest ...`)
        sudo git clean -ffdx . || true

    - template: templates/e2e-setup.yaml
    - template: templates/e2e-run.yaml
