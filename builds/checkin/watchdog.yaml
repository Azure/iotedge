trigger: none
pr:
  branches:
    include:
      - master
      - release/*
  paths:
    include:
      - "edge-hub/watchdog/*"
      - "builds/*"

jobs:
  ################################################################################
  - job: linux_amd64
  ################################################################################
    displayName: Linux amd64
    pool:
      vmImage: "ubuntu-16.04"
    steps:
      - script: echo "##vso[task.setvariable variable=RUST_BACKTRACE;]1"
        displayName: Set env variables
      - bash: scripts/linux/generic-rust/install.sh --project-root "edge-hub/watchdog"
        displayName: Install Rust
      - bash: scripts/linux/generic-rust/build.sh --project-root "edge-hub/watchdog" --packages "watchdog"
        displayName: Build
      - bash: scripts/linux/generic-rust/install.sh --project-root "edge-hub/watchdog"
        displayName: Install Rust
      - bash: scripts/linux/generic-rust/format.sh --project-root "edge-hub/watchdog"
        displayName: Format Code
      - bash: edge-hub/watchdog/build/clippy.sh
        displayName: Clippy
