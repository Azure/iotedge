trigger: none
pr:
  branches:
    include:
      - master
      - release/*
jobs:


################################################################################
  - job: linux_amd64
################################################################################
    displayName: Linux amd64
    pool:
      vmImage: "ubuntu-18.04"
    steps:
      - template: ../templates/install-dotnet2.yaml
      - template: ../templates/install-dotnet3.yaml
      - task: Bash@3
        displayName: Install Prerequisites
        inputs:
          filePath: scripts/linux/installPrereqs.sh
      - task: Bash@3
        displayName: Build
        inputs:
          filePath: scripts/linux/buildBranch.sh
          arguments: -c "$(configuration)"
      - task: Bash@3
        displayName: Test
        inputs:
          filePath: scripts/linux/runTests.sh
          arguments: '"--filter Category=Unit"'
      - task: PublishTestResults@2
        displayName: Publish Test Results
        inputs:
          testRunner: VSTest
          testResultsFiles: "**/TestResults/*.trx"
        condition: succeededOrFailed()
